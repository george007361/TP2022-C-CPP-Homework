name: HW1_CI
on: [push]
jobs:
  GTest_and_cov:
    name: GTest and coverage
    runs-on: ubuntu-latest
    steps:
      - name: Setup LCOV
        uses: hrishikesh-kadam/setup-lcov@v1
      - name: Build Tests
      - uses: actions/checkout@v2
      - run: cmake -B build -DCOVERAGE=ON
      - run: make -C build
      - name: Run tests
      - run: ./build/lib/functions/tests/test_functions
      - run: ./build/lib/restoraunt/tests/test_restoraunt
      - name: Generate coverage report
      - run: cd ./build
      - run: lcov -t "TESTS" -d ./lib -c -o covrep.info
      - name: Upload coverage report
      - run: bash <(curl -s https://codecov.io/bash) -f covrep.info
